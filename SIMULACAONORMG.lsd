	
Label Root
{
	Son: FARM
	Label FARM
	{
		Var: C
		Var: A
		Var: Af
		Var: g
		Var: I
		Var: p
		Var: PROB_IN
		Var: Z
		Param: a
		Param: b
		Param: CO
		Param: Dp
		Param: f
		Param: price
		Param: t
		Param: x
		Var: PROB_IM
		Param: A0
		Var: REC
		Var: Im
		Var: In
		Param: s
		Var: gmean
		Param: rho1
		Var: rin
		Param: rim
		Var: ADD
		Param: alpha1
		Param: beta1
		Param: x1inf
		Param: x1sup
		Var: E
		Param: u
		Param: s1
		Var: REC2
		Param: rho
		Var: az
		Var: T
		Var: z
		Var: gnorm

	}


}


DATA

Object: Root C	1

Object: FARM C	10
Var: C 0 s + n n
Var: A 7 s + n n	2986.50355325438	2983.86049492525	2996.42449690488	2870.70195878812	2492.70953919634	500	0	3003.12193278815	2997.04419597549	2945.58746046795	2987.89715237768	2506.70017179989	500	0	3008.10556469131	3008.09773948841	3005.70760472603	2897.79814110437	2509.37735542248	500	0	2988.7385917526	2986.8982459723	2991.3494607265	2878.31850047781	2494.42068085965	500	0	2990.44536219586	2985.32802934888	2999.71573867836	2878.03357365605	2496.16334101014	500	0	2995.88809996195	2983.75695060433	2940.60324905874	2984.1673226718	2500.94441192736	500	0	2991.39635789895	2988.08323688986	2972.21498377416	2892.76267159411	2493.76763952094	500	0	3011.5182826699	3008.30400581408	2992.22412208334	2911.82624168159	2509.85762603836	500	0	3011.60794183739	3008.39502543946	2992.31359735888	2911.90926121164	2509.92922651096	500	0	3010.88863186577	3007.67366562778	2991.59883443786	2911.22467848825	2509.35389874021	500	0
Var: Af 1 s + n n	2996.27739272925	2996.26615224144	2996.38582671393	2996.17282712311	2996.52051914492	2997.74037239216	3000.01508875004	2999.99981933591	2999.99963779818	3000
Var: g 1 s + n n	620.789563631639	7.00246549970492	6.76574972104556	6.81054274925167	6.87007133842518	6.94692730849894	6.45327311348908	6.45312900556151	6.453128382395	6.45313354119964
Var: I 1 s + n p	6538.25741911022	6512.98669454508	6471.10986167737	6456.58713114535	6430.95904793268	6381.16773214028	6274.3762743516	6274.93048613281	6274.9329817084	6274.91321209566
Var: p 6 s + n n	-186834.303128174	43588.3827940682	-9172.4358200166	673.323937500154	158.114003999198	235.7	-186323.670503648	43419.9112969672	-9125.04151994589	862.494224987428	161.052036077977	235.7	-185857.524866995	43140.7324111824	-8906.14012772449	678.489101335921	161.614244638722	235.7	-185358.558547458	43043.9142076357	-8971.73645141717	674.869512053074	158.473342980527	235.7	-184757.214764585	42873.0603195512	-9054.12772624347	674.754783625765	158.839301612129	235.7	-184065.733114254	42541.1182142685	-9047.44353504189	861.892267185179	159.843326504745	235.7	-183546.650743324	41829.175162344	-8471.22035382597	677.923358789666	158.336204299398	235.7	-183543.021748073	41832.8699075521	-8467.54291205251	681.419873932738	161.715101468055	235.7	-183543.005598562	41832.8865447227	-8467.52639904761	681.435052619161	161.730137567302	235.7	-183543.1353663	41832.7547473044	-8467.65765332895	681.309413072029	161.609318735444	235.7
Var: PROB_IN 0 s + n n
Var: Z 1 s + n n	-47072440.1861897	-46967534.7133804	-46891401.3521611	-46775745.9666158	-46646375.8582181	-46519410.4871696	-46497691.3820882	-46497254.605513	-46497252.6367559	-46497268.2158665
Param: a 0 n + n n	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2
Param: b 0 n + n n	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8
Param: CO 0 s + n n	330	330	330	330	330	330	330	330	330	330
Param: Dp 0 n + n n	0.06	0.06	0.06	0.06	0.06	0.06	0.06	0.06	0.06	0.06
Param: f 0 s + n n	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2
Param: price 0 n + n n	0.21	0.21	0.21	0.21	0.21	0.21	0.21	0.21	0.21	0.21
Param: t 0 n + n n	0.3	0.3	0.3	0.3	0.3	0.3	0.3	0.3	0.3	0.3
Param: x 0 n + n n	350	350	350	350	350	350	350	350	350	350
Var: PROB_IM 0 s + n n
Param: A0 0 n + n n	3000	3000	3000	3000	3000	3000	3000	3000	3000	3000
Var: REC 1 s + n n	627.165746183421	630.65560588551	631.702168585175	627.635104268047	627.99352606113	629.136500992009	628.193235158779	632.41883936068	632.437667785853	632.286612691811
Var: Im 1 s + n n	3269.12870955511	3256.49334727254	-667.960509579337	-672.880233856288	-679.05957946826	-678.558265128142	-635.341526536948	-635.065718403938	-635.06447992857	-635.074323999671
Var: In 1 s + n n	3269.12870955511	3256.49334727254	-667.960509579337	-672.880233856288	-679.05957946826	-678.558265128142	-635.341526536948	-635.065718403938	-635.06447992857	-635.074323999671
Param: s 0 s + n n	0.001	0.001	0.001	0.001	0.001	0.001	0.001	0.001	0.001	0.001
Var: gmean 2 s + n n	-2706.7912462841	620.789563631639	619.200682289142	-135.811152695729	617.525434643806	-135.203757477968	615.909780574023	-134.809564045131	614.013670497297	-134.124568630022	611.913306795389	-132.910528374748	610.015070144291	-131.268136312123	610.015070144291	-131.268136312123	610.015070144291	-131.268136312123	610.015070144291	-131.268136312123
Param: rho1 0 s + n n	0.1	0.1	0.1	0.1	0.1	0.1	0.1	0.1	0.1	0.1
Var: rin 0 s + n n
Param: rim 1 s + n n	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5	0.5
Var: ADD 1 s + n n	643.207651825333	-2820.89990559159	638.364918166418	682.640998355892	641.834341718873	561.165779919372	580.458369525392	589.19442288972	570.883684080335	575.026016112571
Param: alpha1 0 n + n n	1	1	1	1	1	1	1	1	1	1
Param: beta1 0 n + n n	1	1	1	1	1	1	1	1	1	1
Param: x1inf 0 n + n n	-0.15	-0.15	-0.15	-0.15	-0.15	-0.15	-0.15	-0.15	-0.15	-0.15
Param: x1sup 0 n + n n	0.15	0.15	0.15	0.15	0.15	0.15	0.15	0.15	0.15	0.15
Var: E 0 s + n n
Param: u 0 n + n n	-7.29045991406439	6.70017179989159	9.37735542248463	-5.5793191403459	-3.83665898985993	0.944411927357038	-6.23236047905638	9.85762603835613	9.92922651096017	9.35389874021005
Param: s1 0 s + n n	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2	0.2
Var: REC2 1 n + n n	6.26610703934302	6.29379281154854	6.31700525292567	6.27248631654184	6.26918886163265	6.26588959626909	6.2749747974687	6.31743841220957	6.31762955342286	6.31611469781834
Param: rho 0 n + n n	0.01	0.01	0.01	0.01	0.01	0.01	0.01	0.01	0.01	0.01
Var: az 0 n + n n
Var: T 0 s + n n
Var: z 0 n + n n
Var: gnorm 1 n + n n	-2736.26077962495	-2728.95968810589	-2722.54722990762	-2715.14555334213	-2706.428018829	-2696.72275580463	-2690.46163188077	-2690.46227426213	-2690.46227703999	-2690.46225404389

SIM_NUM 1
SEED 2
MAX_STEP 100
EQUATION fun_newmodel.cpp
MODELREPORT report_simulacaoMEAEXTV.html

DESCRIPTION

Object_Root

END_DESCRIPTION

Object_FARM

END_DESCRIPTION

Variable_C
Cost function
END_DESCRIPTION

Variable_A
Produtividade
 
A produtividade da área plantada "A" depende do parâmetro "a" que representa a velocidade do aprendizado (ou velocidade de assimilação de conhecimento tecnológico. Quanto menor for este parâmetro, mais rápido será o aprendizado e maior a produtividade.
Produtividade
 
A produtividade da área plantada "A" depende do parâmetro "a" que representa a velocidade do aprendizado (ou velocidade de assimilação de conhecimento tecnológico. Quanto menor for este parâmetro, mais rápido será o aprendizado e maior a produtividade.
'A' appears in the equation for: A, p, I
_INIT_
All 1000 instances equal to 500
END_DESCRIPTION

Variable_Af
Produtividade Final
 
"Af" define o aumento ou decréscimo da produtividade. Determina o limite da produtividade no final de cada simulação. O parâmetro "x" multiplica o grau de conhecimento tecnológico "T" e soma à produtividade final no tempo zero "A0" para cada agricultor.
_INIT_
All 10 instances equal to 3000
END_DESCRIPTION

Variable_g
Capacidade de Absorção futura (Inn = 0 IMITATOR, Inn = 1 INNOVATOR)
É função da capacidade de absorção passada ("g", 1), do investimento realizado "I", de um parâmetro "b" que especifica a complexidade do conhecimento assimilado e da depreciação da capacidade de absorção "Dp"
_INIT_
All 10 instances equal to 0.3
END_DESCRIPTION

Variable_I
Investment function
_INIT_
All 10 instances equal to 94
END_DESCRIPTION

Variable_p
Profit function
_INIT_
All 10 instances equal to 235.7
END_DESCRIPTION

Variable_PROB_IN
Sucess Probability of Innovation
END_DESCRIPTION

Variable_Z
Estoque de conhecimento
 
O estoque de conhecimento "Z" é função do investimento do agricultor "I", da sua capacidade de absorção "g", do efeito spillover "t", do total de investimento realizado por outros produtores "SUM("I") e do conhecimento externo "E"
_INIT_
All 100 instances equal to 350
END_DESCRIPTION

Parameter_a

_INIT_
All 10 instances equal to 0.2
END_DESCRIPTION

Parameter_b

_INIT_
All 10 instances equal to 0.8
END_DESCRIPTION

Parameter_CO

_INIT_
All 1 instances equal to 330
END_DESCRIPTION

Parameter_Dp

_INIT_
All 10 instances equal to 0.06
END_DESCRIPTION

Parameter_f

_INIT_
All 10 instances equal to 0.2
END_DESCRIPTION

Parameter_price

_INIT_
All 1 instances equal to 0.21
END_DESCRIPTION

Parameter_t

_INIT_
All 10 instances equal to 0.3
END_DESCRIPTION

Parameter_x

_INIT_
All 10 instances equal to 350
END_DESCRIPTION

Variable_PROB_IM
Sucess Probability of Imitation
END_DESCRIPTION

Parameter_A0

_INIT_
All 10 instances equal to 3000
END_DESCRIPTION

Variable_REC

_INIT_
All 10 instances equal to 1000
END_DESCRIPTION

Variable_Im
Investment function imitation
_INIT_
All 10 instances equal to 47
END_DESCRIPTION

Variable_In
Investment function inovation
_INIT_
All 10 instances equal to 47
END_DESCRIPTION

Parameter_s

_INIT_
All 10 instances equal to 0.001
END_DESCRIPTION

Variable_gmean
Farms AC average
END_DESCRIPTION

Parameter_rho1

_INIT_
All 10 instances equal to 0.1
END_DESCRIPTION

Variable_rin

END_DESCRIPTION

Parameter_rim

_INIT_
All 10 instances equal to 0.5
END_DESCRIPTION

Variable_ADD

_INIT_
All 10 instances equal to 1
END_DESCRIPTION

Parameter_alpha1

_INIT_
All 10 instances equal to 1
END_DESCRIPTION

Parameter_beta1

_INIT_
All 10 instances equal to 1
END_DESCRIPTION

Parameter_x1inf

_INIT_
All 10 instances equal to -0.15
END_DESCRIPTION

Parameter_x1sup

_INIT_
All 10 instances equal to 0.15
END_DESCRIPTION

Variable_E

END_DESCRIPTION

Parameter_u

_INIT_
All 10 instances drawn from uniform distribution between -10 and 10
END_DESCRIPTION

Parameter_s1

_INIT_
All 10 instances equal to 0.2
END_DESCRIPTION

Variable_REC2

_INIT_
All 10 instances equal to 100
END_DESCRIPTION

Parameter_rho

_INIT_
All 10 instances equal to 0.01
END_DESCRIPTION

Variable_az
Average z
END_DESCRIPTION

Variable_T
Grau de conhecimento tecnológico "T" 
 É função do estoque de conhecimento comparado à média do mercado. A taxa de crescimento do estoque de conhecimento "z" é dada pela variação do conhecimento no período presente e o anterior (derivada do estoque de conhecimento no tempo)
END_DESCRIPTION

Variable_z
Knowledge increase rate
END_DESCRIPTION

Variable_gnorm

_INIT_
All 10 instances equal to 0.3
END_DESCRIPTION


DOCUOBSERVE

END_DOCUOBSERVE


DOCUINITIAL

END_DOCUINITIAL


EQ_FILE
//#define EIGENLIB			// uncomment to use Eigen linear algebra library

#include "fun_head_fast.h"

// do not add Equations in this area

MODELBEGIN









EQUATION("A")
// Produtividade
/* 
A produtividade da área plantada "A" depende do parâmetro "a" que representa a velocidade do aprendizado (ou velocidade de assimilação de conhecimento tecnológico. Quanto menor for este parâmetro, mais rápido será o aprendizado e maior a produtividade. 
*/ 

v[0] = V("a")*VL("A", 1) + (1 - V("a"))*V("Af")+ V("u");



RESULT(v[0]) 


EQUATION("Af")
// Produtividade Final
/* 
"Af" define o aumento ou decréscimo da produtividade. Determina o limite da produtividade no final de cada simulação. O parâmetro "x" multiplica o grau de conhecimento tecnológico "T" e soma à produtividade final no tempo zero "A0" para cada agricultor.
*/

RESULT(V("x")*V("T") + V("A0"))



EQUATION("T")
// Grau de conhecimento tecnológico "T" 

/* É função do estoque de conhecimento comparado à média do mercado. A taxa de crescimento do estoque de conhecimento "z" é dada pela variação do conhecimento no período presente e o anterior (derivada do estoque de conhecimento no tempo) */

RESULT((V("z") - V("az"))/V("az"))


EQUATION("az")
// Average z
STAT("z");
RESULT(v[1])

EQUATION("z")
// Knowledge increase rate
RESULT((V("Z") - VL("Z", 1))/VL("Z", 1))


EQUATION("Z")
// Estoque de conhecimento
/* 
O estoque de conhecimento "Z" é função do investimento do agricultor "I", da sua capacidade de absorção "gnorm", do efeito spillover "t", do total de investimento realizado por outros produtores "SUM("I") e do conhecimento externo "E" 
*/
v[1]= V("I");
v[2]= V("gnorm");
v[3]= V("t");
v[4]= SUM("I");
v[5]= v[4]-v[1];
v[6]= V("E");
v[7]=v[3]*v[5];
v[8]= v[1] + v[2]*(v[7]+v[6]);

RESULT( v[8] )
/*=================================ADDITION===========================*/
/*
EQUATION("E")

if (T<200)
{
v[0]= 250 + norm(100,10);
}

if (T>200)
{
v[0]= 275+norm(100,10);
}

if (T>400)
{
v[0]=300+ norm(100,10);
}

if (T>600)
{
v[0]=400+ norm(10,10);
}

if (T>800)
{
v[0]=350+ norm(100,10);
}

if (T>900)
{
v[0]=500+ norm(100,10);
}

if (T>1000)
{
v[0]=575+norm(100,10);
}

if (T>1100)
{
v[0]= 395+norm(100,10);
}

if (T>1200)
{
v[0]= 435+norm(100,10);
}
if (T>1400)
{
v[0]= 300+norm(100,10);
}

if (T>1600)
{
v[0]= 375+norm(100,10);
}

if (T>1700)
{
v[0]=500+norm(100,10);
}



RESULT ( v[0] ) 
*/





/////////////////////////BLOCO DE SELEÇÃO DA PROB///////////////////////////////////////////


//inovar e imitar tem a mesma dificuldade, modular ou criar um outro parametro diferente de s
EQUATION("PROB_IM")
// Sucess Probability of Imitation
v[0] = 1;
v[1] = exp(-V("s1")*V("Im"));
v[2] = v[0] - v[1];
v[3] = bernoulli(v[2]);
RESULT(v[3])

EQUATION("PROB_IN")
// Sucess Probability of Innovation
v[0] = 1;
v[1] = exp(-V("s")*V("In"));
v[2] = v[0] - v[1];
v[3] = bernoulli(v[2]);
RESULT(v[3])




 EQUATION("g")
// Capacidade de Absorção futura (Inn = 0 IMITATOR, Inn = 1 INNOVATOR)
/*
É função da capacidade de absorção passada ("gnorm", 1), do investimento realizado "I", de um parâmetro "b" que especifica a complexidade do conhecimento assimilado e da depreciação da capacidade de absorção "Dp"

*/

v[0]=0;

if (V("PROB_IM")==1)  
{        
if (V("PROB_IN")==0)
{
// Sucesso do Imitador 
   v[0] = max(VL("g", 1),VL("gmean", 1)); 
}

if (V("PROB_IN")==1)
{
  v[0] = VL("g", 1) + V("b")/sqrt(VL("In", 1)) + V("ADD");
}
}

if (V("PROB_IM")==0)
{
if (V("PROB_IN")==0)
{
 v[0] = (min(VL("g", 1), VL("g", 1) + V("b")/sqrt(VL("Im", 1)) - V("Dp")) +  VL("g", 1) + (V("b")/sqrt(VL("In", 1))) - V("Dp"))/2;
 
}

if (V("PROB_IN")==1)
{
// Sucesso do Inovador
   v[0] = VL("g", 1) + V("b")/sqrt(VL("In", 1)) + V("ADD")/VL("ADD",1);
}
}



RESULT (v[0])







EQUATION("gnorm")
v[0]=V("g");
v[1]=V("gmean");
v[2]=SD("g");
RESULT((v[0]-v[1])/v[2])


EQUATION("ADD")


 v[5]= VL("gnorm",1);							//previous period productivity


v[1]=  V( "x1inf" );		// lower beta inno. draw support
v[2]=  V( "x1sup" );		// upper beta inno. draw support
v[3]=  V( "alpha1" );		// beta distrib. alpha parameter
v[4]=  V( "beta1" );		// beta distrib. beta parameter

	// new final productivity (A) from innovation
	v[0] = v[5] * ( 1 + v[1] + beta( v[3], v[4]) * ( v[2] - v[1] ) );
	
RESULT ( v[0] )


EQUATION("C")
// Cost function
RESULT(((V("CO")*(1-(V("f")*V("gnorm"))) + V("I"))))

EQUATION("p")
// Profit function
RESULT(V("REC") - V("C")) // alterado por wellington questão do C grande 


EQUATION("REC") // ALTERADO PARA TER AS CONDIÇÕES INICIAIS DESCRITAS NA TESE DO AUTOR
v[0]=V("price");
v[1]=V("A");
RESULT(v[0]*v[1])



///////////////bloco investimento//////////////////////

//EQUATION("In")
// Investment function inovation
//

EQUATION("Im")
// Investment function imitation
RESULT(V("rim")*(VL("I",1)))


EQUATION ("rin")
RESULT (1 - V("rim"))

// EQUATION("rim")
// v[11]= VL("A",1);
// v[12]= VL("A",2);
// v[13]= VL("A",3);
// v[14]= VL("A",4);
// v[15]= VL("A",5);
// v[16]= VL("A",6);
// v[17]= VL("A",7);

// v[18]= v[11]-v[12]/v[12];
// v[19]= v[12]-v[13]/v[13];
// v[20]= v[14]-v[15]/v[15];
// v[21]= v[16]-v[15]/v[16];
// v[22]= v[16]-v[17]/v[17];

// v[23]= v[18]+v[19]+v[20]+v[21]+v[22]/5;

// if (VL("rim",1)>0)
// {
// if (v[23]<0)
// { 

// v[1] = 1;
// v[2] = exp(-V("s1")*v[0]);
// v[4] = v[1] - v[2];
// v[5] = bernoulli(v[4]);

// if (bernoulli (v[4]))
// {

// v[3]= VL("rim",1) - norm(0,0.015) ;

// }
// else
// {
// v[3]= VL("rim",1);
// }
// }

// if (v[23]>0)
// { 
// v[3]= VL("rim",1);
// }
// }

// if (VL("rim",1)==0)
// {
// v[3]=VL("rim",1);
// }


// RESULT(v[3])




// EQUATION("I")
// RESULT(V("In")+V("Im"))

EQUATION("I")
RESULT(0.15*VL("p",1))

EQUATION("gmean")
// Farms AC average
v[0] = 0;
v[1] = 0;

CYCLE(cur, "FARM")
{
v[0] = v[0] + VLS(cur, "gnorm", 1);
v[1] = v[1] + 1;
}
RESULT(v[0]/v[1])

EQUATION("REC2")
v[0]= VL("REC",1);
v[1]= V("rho");

v[2]= v[0]*v[1];
RESULT( v[2] ) 

EQUATION("In")
// Investment function inovation
RESULT(V("rin")*VL("I",1))


EQUATION("E")
v[0]=0;
RESULT(v[0])






MODELEND

// do not add Equations in this area

void close_sim( void )
{
	// close simulation special commands go here
	}

END_EQ_FILE
